(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-983fd998"],{"537c":function(e,t,n){},"579d":function(e,t,n){"use strict";n("537c")},"5c56":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{height:"100%"}},[t("Breadcrumb",{staticClass:"breadcrumb"},[t("Breadcrumb-Item",[e._v("青龙配置文件编辑")]),t("Breadcrumb-Item",[t("Select",{staticStyle:{width:"200px"},attrs:{filterable:""},on:{"on-change":e.changeSelectQL},model:{value:e.SelectQLId,callback:function(t){e.SelectQLId=t},expression:"SelectQLId"}},e._l(e.QLPanels,(function(n){return t("Option",{key:n.value,attrs:{value:n.Id}},[e._v(e._s(n.Name))])})),1)],1),t("Breadcrumb-Item",[t("Select",{staticStyle:{width:"200px"},attrs:{filterable:""},on:{"on-change":e.getFile},model:{value:e.SelectFileName,callback:function(t){e.SelectFileName=t},expression:"SelectFileName"}},e._l(e.Files,(function(n){return t("Option",{key:n.value,attrs:{value:n.value}},[e._v(e._s(n.title))])})),1)],1)],1),t("monaco-editor",{staticClass:"editor",attrs:{language:e.getLanguage,readOnly:!1,editorMounted:e.onEditorMounted},on:{change:e.onChange},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),t("footer",[t("div",{staticStyle:{float:"left"}},[t("div",{staticStyle:{float:"left","margin-right":"10px"}},[e._v("\n        容器同步\n        "),t("Checkbox",{on:{"on-change":e.SelectAllQLChange},model:{value:e.SelectAllQL,callback:function(t){e.SelectAllQL=t},expression:"SelectAllQL"}},[e._v("\n          全选\n        ")])],1),e._l(e.QLPanels,(function(n){return t("div",{key:n.Id,staticStyle:{float:"left","margin-right":"10px"}},[t("Checkbox",{model:{value:n.Enable,callback:function(t){e.$set(n,"Enable",t)},expression:"data.Enable"}},[e._v("\n          "+e._s(n.Name)+"\n        ")])],1)}))],2),t("Button",{staticClass:"saveBtn",attrs:{type:"primary"},on:{click:e.saveFile}},[e._v("保存")])],1)],1)},l=[],i=(n("28a5"),n("ad8c")),c=n("66df"),o=function(e){return c["a"].request({url:"/api/QLConfig/"+e,method:"get"})},s=function(e,t){return c["a"].request({url:"/api/QLConfig/".concat(e,"/").concat(t),method:"get"})},u=function(e){return c["a"].request({url:"/api/QLConfig/save",data:e,method:"post"})},r=n("2b77"),d={data:function(){return{content:"{}",SelectAllQL:!0,QLPanels:[],Files:[],SelectQLId:null,SelectFileName:null,Languages:{".py":"python",".js":"javascript",".json":"json",".sh":"shell",".ts":"typescript"}}},computed:{getLanguage:function(){if(this.SelectFileName){var e=this.SelectFileName.split(".");return this.Languages["."+e[e.length-1]]}return"javascript"}},components:{MonacoEditor:r["a"]},loadQLPanels:function(){var e=this;Object(i["b"])().then((function(t){e.QLPanels=t}))},methods:{getQLPanels:function(){var e=this;Object(i["b"])().then((function(t){e.QLPanels=t.filter((function(e){return e.Enable})),e.SelectQLId=t[0].Id,e.getFiles()}))},SelectAllQLChange:function(){this.updateCheckQLs()},getFiles:function(){var e=this;o(this.SelectQLId).then((function(t){e.Files=t,e.SelectFileName="config.sh",e.getFile()}))},getFile:function(){var e=this;console.log("getFile"),s(this.SelectQLId,this.SelectFileName).then((function(t){e.content=t}))},changeSelectQL:function(){this.updateCheckQLs(),this.getFiles()},updateCheckQLs:function(){for(var e=0;e<this.QLPanels.length;e++)this.QLPanels[e].Enable=this.SelectAllQL?this.SelectAllQL:this.SelectQLId==this.QLPanels[e].Id},saveFile:function(){for(var e=this,t=[],n=0;n<this.QLPanels.length;n++)this.QLPanels[n].Enable&&t.push(this.QLPanels[n].Id);u({name:this.SelectFileName,content:this.content,QLIds:t}).then((function(t){e.$Notice.success({desc:"修改青龙配置文件成功"})})).catch((function(e){this.$Notice.error({title:"保存青龙配置文件失败",desc:e})}))},onChange:function(e){},onEditorMounted:function(e,t){window.editor=e,window.monaco=t}},mounted:function(){this.getQLPanels()}},h=d,f=(n("579d"),n("2877")),g=Object(f["a"])(h,a,l,!1,null,"448d2574",null);t["default"]=g.exports},ad8c:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s}));var a=n("66df"),l=function(e){return a["a"].request({url:"/api/QLPanel",params:e,method:"get"})},i=function(e){return a["a"].request({url:"/api/QLPanel",data:e,method:"post"})},c=function(e){return a["a"].request({url:"/api/QLPanel/"+e,method:"delete"})},o=function(){return a["a"].request({url:"/api/QLPanel/RefreshToken",method:"get"})},s=function(){return a["a"].request({url:"/api/QLPanel/RefreshLogin",method:"get"})}}}]);