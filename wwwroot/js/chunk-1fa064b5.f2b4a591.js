(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1fa064b5"],{"0f37":function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var n=a("66df"),l=function(){return n["a"].request({url:"/api/Enum",method:"get"})}},ad8c:function(t,e,a){"use strict";a.d(e,"b",(function(){return l})),a.d(e,"e",(function(){return o})),a.d(e,"a",(function(){return i})),a.d(e,"d",(function(){return r})),a.d(e,"c",(function(){return s}));var n=a("66df"),l=function(){return n["a"].request({url:"/api/QLPanel",method:"get"})},o=function(t){return n["a"].request({url:"/api/QLPanel",data:t,method:"post"})},i=function(t){return n["a"].request({url:"/api/QLPanel/"+t,method:"delete"})},r=function(){return n["a"].request({url:"/api/QLPanel/RefreshToken",method:"get"})},s=function(){return n["a"].request({url:"/api/QLPanel/RefreshLogin",method:"get"})}},b4c8:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("Form",{attrs:{"label-width":80},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.loadEnvs(1))}}},[a("Row",[a("Col",{attrs:{span:"4"}},[a("FormItem",{attrs:{label:"搜索"}},[a("Input",{attrs:{placeholder:"输入搜索关键字"},model:{value:t.QueryForm.Key,callback:function(e){t.$set(t.QueryForm,"Key",e)},expression:"QueryForm.Key"}})],1)],1),a("Col",{attrs:{span:"4"}},[a("FormItem",{attrs:{label:"青龙面板"}},[a("Select",{attrs:{clearable:""},model:{value:t.QueryForm.QLPanelId,callback:function(e){t.$set(t.QueryForm,"QLPanelId",e)},expression:"QueryForm.QLPanelId"}},t._l(t.QLPanels,(function(e){return a("Option",{key:e.Id,attrs:{value:e.Id}},[t._v(t._s(e.Name))])})),1)],1)],1),a("Col",{attrs:{span:"4"}},[a("FormItem",{attrs:{label:"启用状态"}},[a("Select",{attrs:{clearable:""},model:{value:t.QueryForm.Enable,callback:function(e){t.$set(t.QueryForm,"Enable",e)},expression:"QueryForm.Enable"}},[a("Option",{attrs:{value:"true"}},[t._v("启用")]),a("Option",{attrs:{value:"false"}},[t._v("禁用")])],1)],1)],1),a("Col",{attrs:{span:"4"}},[a("FormItem",{attrs:{label:"变量类型"}},[a("Select",{attrs:{clearable:""},model:{value:t.QueryForm.EnvType,callback:function(e){t.$set(t.QueryForm,"EnvType",e)},expression:"QueryForm.EnvType"}},t._l(t.AllEnums.EnvType,(function(e){return a("Option",{key:e.Value,attrs:{value:e.Value}},[t._v("\n                "+t._s(e.Key)+"\n              ")])})),1)],1)],1),t._v("\n         \n        "),a("Button",{attrs:{type:"info"},on:{click:function(e){return t.loadEnvs(1)}}},[a("Icon",{attrs:{type:"md-search"}}),t._v(" 搜索\n        ")],1)],1)],1)],1),a("div",{staticStyle:{margin:"20px 0"}},[a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.editQLPanel(-1)}}},[a("Icon",{attrs:{type:"md-add"}}),t._v(" 添加\n    ")],1),t._v("\n     \n    "),a("Button",{attrs:{type:"success",size:"small"},on:{click:t.enableEnvs}},[a("i",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}}),t._v("\n      启用\n    ")]),t._v("\n     \n    "),a("Button",{attrs:{type:"warning",size:"small"},on:{click:t.disableEnvs}},[a("i",{staticClass:"fa fa-ban",attrs:{"aria-hidden":"true"}}),t._v(" 禁用\n    ")]),t._v("\n     \n    "),a("Button",{attrs:{type:"warning",size:"small"},on:{click:t.appointQLPanel}},[a("Icon",{attrs:{type:"md-cog"}}),t._v(" 指定容器\n    ")],1),t._v("\n     \n    "),a("Button",{attrs:{type:"warning",size:"small"},on:{click:t.updateWeight}},[a("Icon",{attrs:{type:"md-cog"}}),t._v(" 修改权重\n    ")],1),t._v("\n     \n    "),a("Button",{attrs:{type:"error",size:"small"},on:{click:t.deleteSelection}},[a("Icon",{attrs:{type:"md-trash"}}),t._v(" 删除\n    ")],1)],1),a("Table",{ref:"EnvTable",attrs:{stripe:"",border:"",columns:t.EnvColumns,data:t.EnvData}}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.PageInfo.Total,current:t.QueryForm.PageIndex,"page-size":t.QueryForm.PageSize,"show-sizer":!0,"page-size-opts":t.PageInfo.PageSizeOpts,"show-total":!0},on:{"on-page-size-change":t.pageSizeChange,"on-change":t.loadEnvs}})],1)]),a("Modal",{attrs:{"mask-closable":!1,title:t.EditEnvModal.Title,width:600},model:{value:t.EditEnvModal.Show,callback:function(e){t.$set(t.EditEnvModal,"Show",e)},expression:"EditEnvModal.Show"}},[a("Form",{ref:"EditQLPanelForm",attrs:{model:t.EditEnvModal.Data,rules:t.ruleValidate,"label-width":80}},[a("FormItem",{attrs:{label:"变量名称",prop:"Name"}},[a("Input",{attrs:{maxlength:32,placeholder:"输入环境变量名称"},model:{value:t.EditEnvModal.Data.Name,callback:function(e){t.$set(t.EditEnvModal.Data,"Name",e)},expression:"EditEnvModal.Data.Name"}})],1),a("FormItem",{attrs:{label:"变量值",prop:"Value"}},[a("Input",{attrs:{type:"textarea"},model:{value:t.EditEnvModal.Data.Value,callback:function(e){t.$set(t.EditEnvModal.Data,"Value",e)},expression:"EditEnvModal.Data.Value"}})],1),a("FormItem",{attrs:{label:"变量类型",prop:"EnvType"}},[a("Select",{on:{"on-change":t.EnvTypeChange},model:{value:t.EditEnvModal.Data.EnvType,callback:function(e){t.$set(t.EditEnvModal.Data,"EnvType",e)},expression:"EditEnvModal.Data.EnvType"}},t._l(t.AllEnums.EnvType,(function(e){return a("Option",{key:e.Value,attrs:{value:e.Value}},[t._v("\n            "+t._s(e.Key)+"\n          ")])})),1)],1),t.EditEnvModal.Data.EnvType<3?a("FormItem",{attrs:{label:"容器指定"}},[a("Checkbox",{on:{"on-change":t.SelectAllQLChange},model:{value:t.SelectAllQL,callback:function(e){t.SelectAllQL=e},expression:"SelectAllQL"}},[t._v("\n          全选\n        ")]),t._l(t.EditEnvModal.Data.QLPanelEnvs,(function(e){return a("div",{key:e.QLPanelId,staticStyle:{float:"left","margin-right":"10px"}},[a("Checkbox",{model:{value:e.Enable,callback:function(a){t.$set(e,"Enable",a)},expression:"data.Enable"}},[t._v("\n            "+t._s(e.QLPanelName)+"\n          ")])],1)}))],2):t._e(),a("FormItem",{attrs:{label:"排序权重",prop:"Weight"}},[a("Input",{attrs:{type:"number"},model:{value:t.EditEnvModal.Data.Weight,callback:function(e){t.$set(t.EditEnvModal.Data,"Weight",e)},expression:"EditEnvModal.Data.Weight"}})],1),a("FormItem",{attrs:{label:"开关选项"}},[a("Checkbox",{model:{value:t.EditEnvModal.Data.Enable,callback:function(e){t.$set(t.EditEnvModal.Data,"Enable",e)},expression:"EditEnvModal.Data.Enable"}},[t._v("启用")])],1),2==t.EditEnvModal.Data.EnvType?a("FormItem",{attrs:{label:"用户Id"}},[a("Input",{model:{value:t.EditEnvModal.Data.UserId,callback:function(e){t.$set(t.EditEnvModal.Data,"UserId",e)},expression:"EditEnvModal.Data.UserId"}})],1):t._e(),2==t.EditEnvModal.Data.EnvType?a("FormItem",{attrs:{label:"用户备注"}},[a("Input",{attrs:{type:"textarea"},model:{value:t.EditEnvModal.Data.UserRemark,callback:function(e){t.$set(t.EditEnvModal.Data,"UserRemark",e)},expression:"EditEnvModal.Data.UserRemark"}})],1):t._e(),a("FormItem",{attrs:{label:"系统备注"}},[a("Input",{attrs:{type:"textarea"},model:{value:t.EditEnvModal.Data.Remark,callback:function(e){t.$set(t.EditEnvModal.Data,"Remark",e)},expression:"EditEnvModal.Data.Remark"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleCancel()}}},[t._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("EditQLPanelForm")}}},[t._v("提交")])],1)],1),a("Modal",{attrs:{"mask-closable":!1,title:t.appointModal.Title,width:600},model:{value:t.appointModal.Show,callback:function(e){t.$set(t.appointModal,"Show",e)},expression:"appointModal.Show"}},[a("Form",{attrs:{model:t.appointModal.Data,"label-width":80}},[a("FormItem",{attrs:{label:"容器指定"}},t._l(t.appointModal.Data.QLPanelEnvs,(function(e){return a("div",{key:e.QLPanelId,staticStyle:{float:"left","margin-right":"10px"}},[a("Checkbox",{model:{value:e.Enable,callback:function(a){t.$set(e,"Enable",a)},expression:"data.Enable"}},[t._v("\n            "+t._s(e.QLPanelName)+"\n          ")])],1)})),0)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleCancel()}}},[t._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:t.appointSubmit}},[t._v("提交")])],1)],1),a("Modal",{attrs:{"mask-closable":!1,title:"修改环境变量权重",width:600},model:{value:t.updateWeightModal.Show,callback:function(e){t.$set(t.updateWeightModal,"Show",e)},expression:"updateWeightModal.Show"}},[a("Form",{attrs:{model:t.updateWeightModal.Data,"label-width":80}},[a("FormItem",{attrs:{label:"权重"}},[a("Input",{attrs:{type:"number"},model:{value:t.updateWeightModal.Data.Weight,callback:function(e){t.$set(t.updateWeightModal.Data,"Weight",e)},expression:"updateWeightModal.Data.Weight"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleCancel()}}},[t._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:t.updateWeightSubmit}},[t._v("提交")])],1)],1)],1)},l=[],o=(a("7f7f"),a("0f37")),i=a("66df"),r=function(t){return i["a"].request({url:"/api/Env",params:t,method:"get"})},s=function(t){return i["a"].request({url:"/api/Env",data:t,method:"post"})},d=function(t){return i["a"].request({url:"/api/Env/deletes",data:t,method:"delete"})},u=function(){return i["a"].request({url:"/api/Env/sync",method:"get"})},c=function(t){return i["a"].request({url:"/api/Env/UpdateEnvPanel",data:t,method:"post"})},v=function(t){return i["a"].request({url:"/api/Env/Disable",data:t,method:"put"})},h=function(t){return i["a"].request({url:"/api/Env/Enable",data:t,method:"put"})},p=function(t,e){return i["a"].request({url:"/api/Env/UpdateEnvWeight/"+t,data:e,method:"put"})},E=a("ad8c"),f=a("c276"),m={data:function(){var t=this;return{EnvColumns:[{type:"selection",width:60,align:"center"},{title:"名称",key:"Name",width:120,ellipsis:!0,render:function(e,a){return t.tdTip(e,a,"Name")}},{title:"值",key:"Value",ellipsis:!0,render:function(e,a){return t.tdTip(e,a,"Value")}},{title:"权重",key:"Weight",width:80},{title:"状态",key:"Enable",width:80,render:function(t,e){return t("div",[t("span",{style:{color:e.row.Enable?"green":"red"}},e.row.Enable?"启用":"禁用")])}},{title:"类型",key:"EnvType",width:90,render:function(e,a){return e("div",[e("span",Object(f["c"])(t.AllEnums,"EnvType",a.row.EnvType))])}},{title:"用户",key:"UserId",width:100,ellipsis:!0,render:function(e,a){return t.tdTip(e,a,"UserId")}},{title:"用户备注",key:"UserRemark",width:120,render:function(e,a){return t.tdTip(e,a,"UserRemark")}},{title:"系统备注",key:"Remark",width:120,render:function(e,a){return t.tdTip(e,a,"Remark")}},{title:"分配容器",width:120,render:function(t,e){for(var a="",n=0;n<e.row.QLPanelEnvs.length;n++){var l=e.row.QLPanelEnvs[n];a+=l.QLPanelName+","}return a=a.substring(0,a.length-1),t("div",[t("span",a)])}},{title:"操作",key:"action",width:150,align:"center",render:function(e,a){var n=[];return n.push(e("i",{class:"fa fa-pencil",style:{color:"#ff6a00"},on:{click:function(){t.editQLPanel(a.index)}}})),n.push(e("i",{class:"fa fa-trash",style:{color:"#f00"},on:{click:function(){t.delete([a.row.Id])}}})),e("div",n)}}],QueryForm:{PageIndex:1,PageSize:20},PageInfo:{Total:0,PageSizeOpts:[10,20,50,100,200,500,1e3]},AllEnums:{},QLPanels:[],EnvData:[],appointModal:{Show:!1,Title:"批量指定容器",Data:{EnvIds:[],QLPanelIds:[],QLPanelEnvs:[]}},updateWeightModal:{Show:!1,Data:{Weight:0,EnvIds:[]}},EditEnvModal:{Show:!1,Title:"添加环境变量",Data:{Enable:!0,EnableAll:!1,EnvType:"",Weight:1}},SelectAllQL:!0,ruleValidate:{Name:[{required:!0,message:"变量名称不能为空",trigger:"blur"},{type:"string",pattern:/^[a-zA-Z][a-zA-Z0-9_]{1,32}$/,message:"只能包含数字和字母下划线长度1-32位",trigger:"blur"}],Value:[{required:!0,message:"变量值不能为空",trigger:"blur"}],EnvType:[{required:!0,message:"请选择环境变量类型"}],Weight:[{required:!0,message:"请输入环境变量权重"}]}}},methods:{updateWeight:function(){var t=this.$refs.EnvTable.getSelection();if(null!==t&&0!==t.length){this.updateWeightModal.Data.EnvIds=[];for(var e=0;e<t.length;e++){var a=t[e];this.updateWeightModal.Data.EnvIds.push(a.Id)}this.updateWeightModal.Weight=1,this.updateWeightModal.Show=!0}else this.$Message.warning("请选中环境变量后再操作！")},updateWeightSubmit:function(){var t=this;this.$Modal.confirm({title:"操作确认",content:"是否需改选中的环境变量权重？",okText:"是的",cancelText:"算了",closable:!0,onOk:function(){p(t.updateWeightModal.Data.Weight,t.updateWeightModal.Data.EnvIds).then((function(e){e&&(t.updateWeightModal.Show=!1,t.$Message.success("修改权重成功！"),t.loadEnvs(t.PageInfo.PageIndex))}))}})},appointSubmit:function(){var t=this.appointModal.Data.QLPanelEnvs.filter((function(t){return t.Enable}));if(t&&0!=t.length){var e=this;this.$Modal.confirm({title:"操作确认",content:"是否指定选中的环境变量到勾选的青龙容器？",okText:"是的",cancelText:"算了",closable:!0,onOk:function(){for(var a=[],n=0;n<t.length;n++){var l=t[n];a.push(l.QLPanelId)}c({QLPanelIds:a,EnvIds:e.appointModal.Data.EnvIds}).then((function(t){t&&(e.appointModal.Show=!1,e.$Message.success("环境变量指定容器成功！"),e.loadEnvs(e.PageInfo.PageIndex))}))}})}else this.$Message.warning("未指定任何容器！")},appointQLPanel:function(){var t=this.$refs.EnvTable.getSelection();if(null!==t&&0!==t.length){this.appointModal.Show=!0,this.appointModal.Data.EnvIds=[],this.appointModal.Data.QLPanelEnvs=[];for(var e=0;e<t.length;e++){var a=t[e];this.appointModal.Data.EnvIds.push(a.Id)}for(var n=0;n<this.QLPanels.length;n++){var l=this.QLPanels[n];this.appointModal.Data.QLPanelEnvs.push({QLPanelId:l.Id,Enable:!1,QLPanelName:l.Name})}}else this.$Message.warning("请选中环境变量后再操作！")},pageSizeChange:function(t){this.QueryForm.PageSize=t,console.log(this.QueryForm),this.loadEnvs(1)},tdTip:function(t,e,a){var n=this,l=[];return l.push(t("a",{style:{display:"inline-block",width:"100%",textIndent:"0px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},attrs:{title:e.row[a]},on:{click:function(){n.copy(e.row[a])}}},e.row[a])),t("div",{style:{width:"100%"}},l)},enableEnvs:function(){var t=this.getSelectIds();if(t.length>0){var e=this;this.$Modal.confirm({title:"启用环境变量",content:"确定启用选择的环境变量？",okText:"是的",cancelText:"算了",closable:!0,onOk:function(){h(t).then((function(t){e.loadEnvs(1)}))}})}},disableEnvs:function(){var t=this.getSelectIds();if(t.length>0){var e=this;this.$Modal.confirm({title:"禁用环境变量",content:"确定禁用选择的环境变量？",okText:"是的",cancelText:"算了",closable:!0,onOk:function(){v(t).then((function(t){e.loadEnvs(1)}))}})}},getSelectIds:function(){var t=[],e=this.$refs.EnvTable.getSelection();if(null!==e&&0!==e.length){for(var a=0;a<e.length;a++){var n=e[a];t.push(n.Id)}return t}this.$Message.warning("请选中环境变量后再操作！")},deleteSelection:function(){var t=this.getSelectIds();t.length>0&&this.delete(t)},EnvTypeChange:function(){this.SelectAllQL=1===this.EditEnvModal.Data.EnvType,this.SelectAllQLChange()},handleSubmit:function(t){var e=this;this.$refs[t].validate((function(t){if(t){var a=JSON.parse(JSON.stringify(e.EditEnvModal.Data));a.QLPanelEnvs=a.QLPanelEnvs.filter((function(t){return t.Enable})),s([a]).then((function(t){t&&(e.$Message.success(e.EditEnvModal.Title+"成功！"),e.EditEnvModal.Show=!1,e.loadEnvs())}))}}))},copy:function(t){var e=this;this.$copyText(t).then((function(t){e.$Message.success("复制成功！")}),(function(t){e.$Message.error("复制失败！")}))},SyncEnv:function(){var t=this;this.$Modal.confirm({title:"同步确认",content:"同步操作为单项同步（只将量子中的环境变量同步到青龙）该操作不可逆，确认同步吗？",okText:"是的",cancelText:"算了",closable:!0,onOk:function(){u().then((function(e){e&&(t.$Message.success("同步环境变量到青龙容器成功！"),t.loadEnvs(t.PageInfo.PageIndex))}))}})},handleCancel:function(){this.EditEnvModal.Show=!1,this.appointModal.Show=!1},SelectAllQLChange:function(){for(var t=0;t<this.EditEnvModal.Data.QLPanelEnvs.length;t++)this.EditEnvModal.Data.QLPanelEnvs[t].Enable=this.SelectAllQL},editQLPanel:function(t){var e=this,a=this;t>-1?(this.EditEnvModal.Title="修改环境变量",this.EditEnvModal.Data=JSON.parse(JSON.stringify(this.EnvData[t])),this.EditEnvModal.Data.QLPanelEnvs=[]):(this.EditEnvModal.Data={Enable:!0,EnvType:1,Weight:1,QLPanelEnvs:[]},this.EditEnvModal.Title="添加环境变量");for(var n=function(n){var l=e.QLPanels[n];e.EditEnvModal.Data.QLPanelEnvs.push({QLPanelId:l.Id,Enable:t>-1&&a.EnvData[t].QLPanelEnvs.filter((function(t){return t.QLPanelId===l.Id})).length>0,QLPanelName:l.Name})},l=0;l<this.QLPanels.length;l++)n(l);t<0&&this.SelectAllQLChange(),this.EditEnvModal.Show=!0},delete:function(t){var e=this;this.$Modal.confirm({title:"删除确认",content:"确定删除环境变量吗？该操作不可逆。",okText:"是的，老子要删除",cancelText:"算了，不删了",closable:!0,onOk:function(){d(t).then((function(t){e.loadEnvs(1)}))}})},loadEnvs:function(t){var e=this;this.QueryForm.PageIndex=t,r(this.QueryForm).then((function(t){e.EnvData=t.Data,e.PageInfo.Total=t.TotalCount}))},loadAllEnums:function(){var t=this;Object(o["a"])().then((function(e){t.AllEnums=e}))},getQLPanels:function(){var t=this;Object(E["b"])().then((function(e){t.QLPanels=e}))}},mounted:function(){this.loadEnvs(1),this.loadAllEnums(),this.getQLPanels()}},g=m,b=(a("b8b6"),a("2877")),y=Object(b["a"])(g,n,l,!1,null,null,null);e["default"]=y.exports},b8b6:function(t,e,a){"use strict";a("d863")},d863:function(t,e,a){}}]);